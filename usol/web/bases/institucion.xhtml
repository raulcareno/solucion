<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                template="/templates/mantenimiento.xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:a4j="http://richfaces.org/a4j"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core" >
    <ui:define name="title">
    </ui:define>    
    <ui:define name="datos">
        <h:panelGrid width="100%" id="busqueda" >
            <h:form prependId="false" id="form">

                <p:panel id="registro"  style="width: 700px;" header="Institucion">
                    <!--p:growl id="growl" showDetail="true" sticky="true"  /--> 
                    <!--p:message for="form" /-->
                    <p:messages id="messages" showDetail="false" autoUpdate="true" /> 
                    <h:panelGrid id="Cdisplay" columns="2" cellpadding="4" style="margin:0 auto;">
                         <h:panelGrid id="display" columns="3" cellpadding="4" style="margin:0 auto;">  
                        <h:outputText value="NOMBRE" />  
                        <p:inputText value="#{institucionBean.object.nombre}" id="nombre"  maxlength="100" size="35"  style="font-weight:bold;"/>  
                        <f:verbatim/>
                        <h:outputText value="PAIS: " /> 
                        <p:selectOneMenu   id="pais" label="pais"  value="#{institucionBean.paisSeleccionado}" effect="fade" converter="ConvPais">  
                            <f:selectItems value="#{institucionBean.selectedItemPais}" var="ob"  itemValue="#{ob}"/>  
                            <p:ajax event="change" listener="#{institucionBean.buscarProvincia()}"  update="provincia" />  
                        </p:selectOneMenu>  
                        <f:verbatim/>
                        <h:outputText value="PROVINCIA: " /> 
                        <p:selectOneMenu  id="provincia" label="provincia"  value="#{institucionBean.provinciaSeleccionado}" effect="fade" converter="ConvProvincia">  
                            <f:selectItems value="#{institucionBean.provinciasEncontradas}" var="ob2"  itemValue="#{ob2}"/>  
                            <p:ajax event="change" listener="#{institucionBean.buscarCanton()}"  update="canton" />  
                        </p:selectOneMenu>  
                        <f:verbatim/>
                        <h:outputText value="CANTON: " /> 
                        <p:selectOneMenu immediate="true" id="canton" label="canton"  value="#{institucionBean.cantonSeleccionado}" effect="fade" converter="ConvCanton">  
                            <f:selectItems value="#{institucionBean.cantonesEncontradas}" var="ob3"  itemValue="#{ob3}"/>  
                        </p:selectOneMenu>  <f:verbatim/>
                        <h:outputText value="DIRECCION" />  
                        <p:inputText value="#{institucionBean.object.direccion}" id="direccion"  maxlength="50" size="35"  style="font-weight:bold;"/>  <f:verbatim/>
                        <h:outputText value="LUGAR" />  
                        <p:inputText value="#{institucionBean.object.lugar}" id="Lugar"  maxlength="50" size="35"  style="font-weight:bold;"/>  <f:verbatim/>
                        <h:outputText value="SEDE" />  
                        <p:inputText value="#{institucionBean.object.sede}" id="Sede"  maxlength="50" size="35"  style="font-weight:bold;"/>  <f:verbatim/>
                        <h:outputText value="SUB AREA UNESCO" />  
                        <p:inputText value="#{institucionBean.object.subAreaUnesco}" id="SubAreaUnesco"  maxlength="50" size="35"  style="font-weight:bold;"/>  <f:verbatim/>
                        <h:outputText value="LOGO REPORTES" rendered="#{not empty institucionBean.foto1}"  />  
                        <p:graphicImage id="logoSubido" width="100" rendered="#{not empty institucionBean.foto1}" value="#{pageContext.contextPath}/fotos/#{institucionBean.foto1}"
                                        cache="false" />
                        <p:commandLink update="fileSubir"  actionListener="#{institucionBean.setEsLogo(true)}" oncomplete="modalSubir.show()" id="versubirLogo">
                            <p:graphicImage value="#{pageContext.contextPath}/images/ver.png" />Subir Logo
                        </p:commandLink>
                        <h:outputText value="IMAGEN PORTADA" rendered="#{not empty institucionBean.foto2}"   />  
                        <p:graphicImage id="logoSubido2" width="100" rendered="#{not empty institucionBean.foto2}"  value="#{pageContext.contextPath}/fotos/#{institucionBean.foto2}"
                                        cache="false" />
                        <p:commandLink update="fileSubir" actionListener="#{institucionBean.setEsLogo(false)}" oncomplete="modalSubir.show()"  id="versubirImagen">
                            <p:graphicImage value="#{pageContext.contextPath}/images/ver.png" />Subir Imagen
                        </p:commandLink>
                        <p:inputText  value="#{institucionBean.object.idInstitucion}" converter="JsfConvInteger" id="id"   style="font-weight:bold; width: 15px;visibility: hidden"/>  
                    </h:panelGrid>  
                    <h:panelGrid id="display2" columns="3" cellpadding="4" style="margin:0 auto;">  
                        <h:outputText value="EMAIL" />  
                        <p:inputText value="#{institucionBean.object.email}" id="email"  maxlength="100" size="35"  style="font-weight:bold;"/>  
                        <f:verbatim/>
                        <h:outputText value="REPLY" />  
                        <p:inputText value="#{institucionBean.object.reply}" id="reply"  maxlength="100" size="35"  style="font-weight:bold;"/>  
                        <f:verbatim/>
                        <h:outputText value="CLAVE" />  
                        <p:password value="#{institucionBean.object.clave}" goodLabel="true" redisplay="true" id="clave"  maxlength="100" size="35"  style="font-weight:bold;"/>  
                        <f:verbatim/>
                        <h:outputText value="PUERTO" />  
                        <p:inputText value="#{institucionBean.object.puerto}" id="puerto"  maxlength="100" size="35"  style="font-weight:bold;"/>  
                        <f:verbatim/>
                        <h:outputText value="SMTP" />  
                        <p:inputText value="#{institucionBean.object.smtp}" id="smtp"  maxlength="100" size="35"  style="font-weight:bold;"/>  
                        <f:verbatim/>
                        <h:outputText value="REQ.AUTORIZACION" />  
                        <p:selectBooleanCheckbox value="#{institucionBean.object.autorizacion}" id="ReqAutorizacion" style="font-weight:bold;"/>  
                        <f:verbatim/>
                        <h:outputText value="STARTTLS" />  
                        <p:selectBooleanCheckbox value="#{institucionBean.object.star}" id="star" style="font-weight:bold;"/>  
                        <f:verbatim/>
  
                    </h:panelGrid> 
                    </h:panelGrid> 
                    
                    <h:panelGrid columns="4">
                        <p:commandButton  value="Guardar"  id="guardar"  update=":form:display :form:display2 :form:institucion"   action="#{institucionBean.guardar()}"  icon="guardar" title="Guardar"/>  
                        <p:commandButton value="Limpiar"  id="limpiar" update=":form:display :form:display2" actionListener="#{institucionBean.limpiar()}" icon="nuevo" title="Nuevo">  
                        </p:commandButton> 

                    </h:panelGrid>
                    <p:dialog header="Seleccionar una foto" widgetVar="modalSubir" modal="true"
                               position="top" width="400" visible="false" resizable="false">
                        <p:fileUpload  label="Seleccionar Imagen (click aquÃ­)"
                            style="width:100%; font-size: 150% !important;"
                            fileUploadListener="#{institucionBean.handleFileUpload}"  
                            mode="advanced"  id="fileSubir"
                            update="logoSubido logoSubido2"  
                            auto="true"  oncomplete="modalSubir.hide();" 
                            sizeLimit="1000000"   
                            allowTypes="/(\.|\/)(gif|jpe?g|png)$/"/>  
                        <br />
                        <p:commandButton type="button" value="CANCELAR">
                            <p:ajax oncomplete="modalSubir.hide();" />
                        </p:commandButton>
                    </p:dialog>


                </p:panel>

                <p:panel  style="width: 600px;">
                    <h:panelGrid  columns="4">

                        <h:outputLabel for="textoBuscar" style="font-weight: bold" value="Nombre:" />
                        <p:inputText id="textoBuscar" value="#{institucionBean.textoBuscar}" style="font-weight:bold"/>  
                        <p:commandButton id="buscar" value="Buscar" update="institucion" actionListener="#{institucionBean.buscar()}"  icon="buscar" title="Buscar"/>  

                    </h:panelGrid>
                </p:panel>

                <p:dataTable style="width:600px;" rowsPerPageTemplate="5,10,15,20,25" paginator="true" rows="5"  id="institucion" var="obj" value="#{institucionBean.model}">  
                    <p:column headerText="ID" style="width:10%">  
                        <h:outputText value="#{obj.idInstitucion}" />  
                    </p:column>  
                    <p:column headerText="NOMBRE" style="width:80%">  
                        <h:outputText value="#{obj.nombre}" />  
                    </p:column>  
                    <p:column style="width:10%">  
                        <h:panelGrid style="border-color: transparent;" columns="2">

                            <p:commandButton  id="editarButton" update=":form:display :form:display2"  actionListener="#{institucionBean.editarAction(obj)}" icon="editar" title="Editar">  

                            </p:commandButton>  
                             
                        </h:panelGrid>

                    </p:column>  

                </p:dataTable>  
            </h:form>


        </h:panelGrid>
    </ui:define>
</ui:composition>